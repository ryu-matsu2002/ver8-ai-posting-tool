{# ğŸ“„ templates/prompt_templates.html #}
{% extends "base.html" %}

{% block title %}ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†{% endblock %}

{% block content %}
<h1>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†</h1>

<h2>ä¿å­˜æ¸ˆã¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§</h2>
{% if prompt_templates %}
<table style="width: 100%; border-collapse: collapse; background: #fff; margin-bottom: 30px;">
    <thead>
        <tr style="background-color: #f2f2f2;">
            <th style="border: 1px solid #ddd; padding: 10px;">ã‚¸ãƒ£ãƒ³ãƒ«</th>
            <th style="border: 1px solid #ddd; padding: 10px;">ã‚¿ã‚¤ãƒˆãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</th>
            <th style="border: 1px solid #ddd; padding: 10px;">æœ¬æ–‡ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</th>
            <th style="border: 1px solid #ddd; padding: 10px;">æ“ä½œ</th>
        </tr>
    </thead>
    <tbody>
        {% for template in prompt_templates %}
        <tr>
            <td style="border: 1px solid #ddd; padding: 10px;">{{ template.genre }}</td>
            <td style="border: 1px solid #ddd; padding: 10px;">{{ template.title_prompt[:50] }}...</td>
            <td style="border: 1px solid #ddd; padding: 10px;">{{ template.body_prompt[:50] }}...</td>
            <td style="border: 1px solid #ddd; padding: 10px;">
                <form method="POST" action="{{ url_for('routes.delete_prompt_template', template_id=template.id) }}" style="display: inline-block;">
                    <button type="submit" onclick="return confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')" style="background: #c0392b; color: #fff; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer;">å‰Šé™¤</button>
                </form>
                <button onclick="copyToAutoPost(`{{ template.title_prompt|e }}`, `{{ template.body_prompt|e }}`)" style="background: #3498db; color: #fff; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer;">è‡ªå‹•æŠ•ç¨¿ç”»é¢ã¸åæ˜ </button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã¾ã ä¿å­˜ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
{% endif %}

<h2>æ–°è¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä¿å­˜</h2>
<form method="POST" action="{{ url_for('routes.prompt_templates') }}" style="background: #fff; padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
    <!-- âœ… CSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ  -->
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <label for="genre">ã‚¸ãƒ£ãƒ³ãƒ«åï¼š</label>
    <input type="text" name="genre" id="genre" required style="width: 100%; padding: 10px; font-size: 14px;">

    <label for="title_prompt">ã‚¿ã‚¤ãƒˆãƒ«ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼š</label>
    <textarea name="title_prompt" id="title_prompt" rows="5" required style="width: 100%; padding: 10px; font-size: 14px;"></textarea>
    <small style="color: gray;">â€» å¿…ãš <code>{{ '{{keyword}}' }}</code> ã‚’å«ã‚ã¦ãã ã•ã„</small>

    <label for="body_prompt">æœ¬æ–‡ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼š</label>
    <textarea name="body_prompt" id="body_prompt" rows="8" required style="width: 100%; padding: 10px; font-size: 14px;"></textarea>
    <small style="color: gray;">â€» å¿…ãš <code>{{ '{{title}}' }}</code> ã‚’å«ã‚ã¦ãã ã•ã„</small>

    <button type="submit" style="margin-top: 20px; padding: 10px 20px; background-color: #0073aa; color: white; border: none; border-radius: 4px; font-size: 14px;">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä¿å­˜</button>
</form>
{% endblock %}

{% block scripts %}
<script>
    function copyToAutoPost(titlePrompt, bodyPrompt) {
        sessionStorage.setItem('title_prompt', titlePrompt);
        sessionStorage.setItem('body_prompt', bodyPrompt);
        window.location.href = "{{ url_for('routes.auto_post') }}";
    }
</script>
{% endblock %}
